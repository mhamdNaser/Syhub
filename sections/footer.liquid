{% liquid
  assign newsletter_block = section.blocks | where: 'type', 'socials_newsletter' | first
  assign customer_service_block = section.blocks | where: 'type', 'customer_support' | first
  assign menu_block = section.blocks | where: 'type', 'menu' | first

  if menu_block and menu_block.settings.split_menu
    assign split_menu = true
  endif

  if newsletter_block
    assign button_color = newsletter_block.settings.footer_button_style | split: ' ' | first
    assign button_style = newsletter_block.settings.footer_button_style | split: ' ' | last
  endif

  assign background = section.settings.color_scheme.settings.background
%}

<footer
  class="w-full color-{{ section.settings.color_scheme }} py-8 px-4 md:px-8 lg:px-16"
  style="background-color: {{ background }};"
>
  <div class="max-w-7xl mx-auto">
    <!-- Main Footer Content -->
    <div class="flex flex-wrap justify-between gap-8 mb-8">
      {%- for block in section.blocks -%}
        {%- case block.type -%}
          {%- when '@app' -%}
            <div class="w-full" {{ block.shopify_attributes }}>
              {% render block %}
            </div>

          {%- when 'text' -%}
            {%- if block.settings.title != empty or block.settings.text != empty -%}
              <div class="flex-1 ps-4" {{ block.shopify_attributes }}>
                {%- if block.settings.title != empty -%}
                  <{{ section.settings.title_size_blocks }} class="font-{{ section.settings.title_font }} font-bold mb-4 {% if block.settings.title_underline_style != 'none' %}underline underline-offset-4{% endif %}">
                    {{ block.settings.title }}
                  </{{ section.settings.title_size_blocks }}>
                {%- endif -%}
                {%- if block.settings.text != empty -%}
                  <div class="prose prose-sm">
                    {{ block.settings.text }}
                  </div>
                {%- endif -%}
              </div>
            {%- endif -%}

          {%- when 'html' -%}
            {%- if block.settings.html != empty -%}
              <div class="flex-1 ps-4 font-bold" {{ block.shopify_attributes }}>
                {{ block.settings.html }}
              </div>
            {%- endif -%}

          {%- when 'customer_support' -%}
            <div class="flex-1 ps-4 relative" {{ block.shopify_attributes }}>
              {%- if block.settings.title != empty -%}
                <{{ section.settings.title_size_blocks }} class="font-{{ section.settings.title_font }} font-bold mb-4 {% if block.settings.title_underline_style != 'none' %}underline underline-offset-4{% endif %}">
                  {{ block.settings.title }}
                </{{ section.settings.title_size_blocks }}>
              {%- endif -%}

              {%- if block.settings.extra_customer_support != empty -%}
                <div class="mb-4 prose prose-sm">
                  {{ block.settings.extra_customer_support }}
                </div>
              {%- endif -%}

              <ul class="space-y-2 mb-4">
                {% if shop.phone != empty and block.settings.show_phone_link %}
                  <li>
                    <a
                      href="tel:{{ shop.phone }}"
                      class="flex items-center gap-2 hover:text-{{ section.settings.footer_color }}-fg_hover transition-colors"
                    >
                      üìû {{ shop.phone }}
                    </a>
                  </li>
                {% endif %}
                {% if shop.email != empty and block.settings.show_mail_link %}
                  <li>
                    <a
                      href="mailto:{{ shop.email }}"
                      class="flex items-center gap-2 hover:text-{{ section.settings.footer_color }}-fg_hover transition-colors"
                    >
                      ‚úâÔ∏è {{ shop.email }}
                    </a>
                  </li>
                {% endif %}
                {% if settings.whatsapp != empty and block.settings.show_whatsapp_link %}
                  <li>
                    <a
                      href="https://wa.me/{{ settings.whatsapp }}"
                      class="flex items-center gap-2 hover:text-{{ section.settings.footer_color }}-fg_hover transition-colors"
                    >
                      üí¨ {{ 'footer.whatsapp_html' | t }}
                    </a>
                  </li>
                {% endif %}
              </ul>

              {%- if block.settings.customer_support_img -%}
                <figure class="absolute bottom-0 right-0 w-32 h-32">
                  <img
                    src="{{ block.settings.customer_support_img | image_url: width: 128 }}"
                    alt="{{ block.settings.customer_support_img.alt | default: 'Customer support' | escape }}"
                    class="w-full h-full object-contain"
                    loading="lazy"
                    width=""
                    height=""
                  >
                </figure>
              {%- endif -%}
            </div>

          {%- when 'socials_newsletter' -%}
            <div class="flex-1 ps-4" {{ block.shopify_attributes }}>
              {% if block.settings.show_socials %}
                {%- if block.settings.title != empty -%}
                  <{{ section.settings.title_size_blocks }} class="font-{{ section.settings.title_font }} font-bold mb-4 {% if block.settings.title_underline_style != 'none' %}underline underline-offset-4{% endif %}">
                    {{ block.settings.title }}
                  </{{ section.settings.title_size_blocks }}>
                {%- endif -%}

                {%- liquid
                  assign socials = ''
                  if settings.social_instagram
                    assign socials = socials | append: 'instagram|' | append: settings.social_instagram | append: '->'
                  endif
                  if settings.social_pinterest
                    assign socials = socials | append: 'pinterest|' | append: settings.social_pinterest | append: '->'
                  endif
                  if settings.social_youtube
                    assign socials = socials | append: 'youtube|' | append: settings.social_youtube | append: '->'
                  endif
                  if settings.social_facebook
                    assign socials = socials | append: 'facebook|' | append: settings.social_facebook | append: '->'
                  endif
                  if settings.social_twitter
                    assign socials = socials | append: 'twitter|' | append: settings.social_twitter | append: '->'
                  endif
                  if settings.social_tiktok
                    assign socials = socials | append: 'tiktok|' | append: settings.social_tiktok | append: '->'
                  endif
                  assign socials = socials | strip | split: '->'
                -%}

                {%- if socials.size > 0 -%}
                  <div class="flex gap-4 mb-6">
                    {%- for social in socials -%}
                      {%- if social != blank -%}
                        {%- assign social_info = social | strip | split: '|' -%}
                        {%- assign icon_name =  'icon-' | append: social_info[0] -%}
                        {%- assign icon_url = social_info[1] -%}
                        {%
                          render 'button',
                          type: 'link',
                          url: icon_url,
                          aria_label: icon_name ,
                          target: '_blank',
                          class: 'hover:text-blue-600 transition inline-block',
                          icon: icon_name,
                          icon_size: '24',
                          icon_color: 'white'
                        %}
                      {%- endif -%}
                    {%- endfor -%}
                  </div>
                {%- endif -%}
              {%- endif -%}

              {%- if shop.features.follow_on_shop? and block.settings.enable_follow_on_shop -%}
                <p class="mb-4">
                  {{ shop | login_button: action: 'follow' }}
                </p>
              {%- endif -%}

              {%- if block.settings.show_newsletter -%}
                {%- form 'customer', id: 'newsletter-footer' -%}
                  <input type="hidden" name="contact[tags]" value="newsletter">

                  {%- if form.errors -%}
                    <div class="text-red-500 mb-2">
                      {{ form.errors.messages.email }}
                    </div>
                  {%- elsif form.posted_successfully? -%}
                    <div class="text-green-500 mb-2">
                      {{ 'footer.newsletter.form.success' | t }}
                    </div>
                  {%- endif -%}

                  <div class="w-full max-w-full break-words overflow-hidden">
                    <legend class="sr-only">{{ 'footer.newsletter.title_html' | t }}</legend>

                    <label for="email-{{ section.id }}" class="block mb-2 font-semibold">
                      {{ 'footer.newsletter.subtitle_html' | t }}
                    </label>

                    <div class="flex flex-col gap-2 mb-4">
                      <input
                        type="email"
                        name="contact[email]"
                        id="email-{{ section.id }}"
                        placeholder="{{ 'footer.newsletter.form.email_placeholder' | t }}"
                        class="flex-1 px-3 py-2 border border-gray-300 rounded-md"
                        required
                      >
                      <button
                        type="submit"
                        class="px-4 py-2 rounded-md hover:opacity-90 transition-opacity"
                      >
                        {{ 'footer.newsletter.form.submit_button' | t }}
                      </button>
                    </div>

                    {%- if block.settings.enable_newsletter_terms_checkbox
                      and block.settings.newsletter_terms_text != empty
                    -%}
                      <div class="flex items-center gap-2 mb-4">
                        <input
                          type="checkbox"
                          id="newsletter_check-{{ section.id }}"
                          name="newsletter_check-{{ section.id }}"
                          required
                          class="w-4 h-4"
                        >
                        <label for="newsletter_check-{{ section.id }}" class="text-sm">
                          {{ block.settings.newsletter_terms_text | remove: '<p>' | remove: '</p>' }}
                        </label>
                      </div>
                    {%- endif -%}
                  </div>
                {%- endform -%}
              {%- endif -%}
            </div>

          {%- when 'menu' -%}
            {%- if split_menu -%}
              {%- liquid
                assign first_menu_items_limit = 5 | minus: section.blocks.size | abs
                if first_menu_items_limit == 4
                  assign first_menu_items_limit = 6
                endif
              -%}

              {%- for link in linklists[block.settings.menu].links limit: first_menu_items_limit -%}
                <div class="flex-1 ps-4" {{ block.shopify_attributes }}>
                  <{{ section.settings.title_size_blocks }} class="font-{{ section.settings.title_font }} font-bold mb-4">
                    <a
                      href="{{ link.url }}"
                      class="hover:text-{{ section.settings.footer_color }}-fg_hover transition-colors"
                    >
                      {{ link.title }}
                    </a>
                  </{{ section.settings.title_size_blocks }}>

                  {%- if link.links != blank -%}
                    <ul class="space-y-2">
                      {%- for sub in link.links -%}
                        <li>
                          <a
                            href="{{ sub.url }}"
                            class="text-gray-400 hover:text-{{ section.settings.footer_color }}-fg_hover transition-colors"
                          >
                            {{ sub.title }}
                          </a>
                          {%- if sub.links != blank -%}
                            <ul class="ml-4 space-y-1 mt-1">
                              {%- for subsub in sub.links -%}
                                <li>
                                  <a
                                    href="{{ subsub.url }}"
                                    class="text-gray-400 hover:text-{{ section.settings.footer_color }}-fg_hover transition-colors text-sm"
                                  >
                                    {{ subsub.title }}
                                  </a>
                                </li>
                              {%- endfor -%}
                            </ul>
                          {%- endif -%}
                        </li>
                      {%- endfor -%}
                    </ul>
                  {%- endif -%}
                </div>
              {%- endfor -%}
            {%- else -%}
              {%- for link in linklists[block.settings.menu].links -%}
                <div class="flex-1 min-w-[200px]" {{ block.shopify_attributes }}>
                  <{{ section.settings.title_size_blocks }} class="font-{{ section.settings.title_font }} font-bold mb-4">
                    <a
                      href="{{ link.url }}"
                      class="hover:text-{{ section.settings.footer_color }}-fg_hover transition-colors"
                    >
                      {{ link.title }}
                    </a>
                  </{{ section.settings.title_size_blocks }}>

                  {%- if link.links != blank -%}
                    <ul class="space-y-2">
                      {%- for sub in link.links -%}
                        <li>
                          <a
                            href="{{ sub.url }}"
                            class="text-gray-400 hover:text-{{ section.settings.footer_color }}-fg_hover transition-colors"
                          >
                            {{ sub.title }}
                          </a>
                        </li>
                      {%- endfor -%}
                    </ul>
                  {%- endif -%}
                </div>
              {%- endfor -%}
            {%- endif -%}
        {%- endcase -%}
      {%- endfor -%}
    </div>

    <!-- Bottom Bar -->
    <div class="border-t border-{{ section.settings.bottom_color }}-bd pt-6 mt-6">
      <div class="flex flex-col md:flex-row justify-between items-center gap-4">
        {%- if section.settings.bottom_img -%}
          <div class="flex-shrink-0">
            {%- if section.settings.bottom_img_link != empty -%}
              <a href="{{ section.settings.bottom_img_link }}">
            {%- endif -%}
            <img
              src="{{ section.settings.bottom_img | image_url: width: section.settings.bottom_img_width }}"
              alt="{{ section.settings.bottom_img.alt | default: 'Footer image' | escape }}"
              class="h-8 w-auto"
              loading="lazy"
              width="auto"
              height="auto"
            >
            {%- if section.settings.bottom_img_link != empty -%}
              </a>
            {%- endif -%}
          </div>
        {%- endif -%}

        <p class="text-sm text-{{ section.settings.bottom_color }}-fg">
          ¬© {{ 'now' | date: '%Y' }}
          {{ shop.name }}, {{ powered_by_link }}
        </p>

        <div class="flex items-center gap-4">
          {%- if section.settings.enable_country_selector and localization.available_countries.size > 1 -%}
            {% render 'language-country-selector' %}
          {%- endif -%}

          {%- if section.settings.enable_language_selector and localization.available_languages.size > 1 -%}
            {% render 'language-country-selector' %}
          {%- endif -%}
        </div>

        {%- if shop.features.follow_on_shop? and section.settings.enable_follow_on_shop -%}
          <p class="follow-on-shop">
            {{ shop | login_button: action: 'follow' }}
          </p>
        {%- endif -%}

        {%- if section.settings.show_payment_methods -%}
          <div class="flex items-center gap-2">
            {%- for payment_method in shop.enabled_payment_types -%}
              <div class="w-8 h-8">
                {{ payment_method | payment_type_svg_tag }}
              </div>
            {%- endfor -%}
          </div>
        {%- endif -%}
      </div>
    </div>
  </div>
</footer>

{% schema %}
{
  "name": "t:static_sections.footer.name",
  "class": "shopify-section-footer",
  "tag": "footer",
  "settings": [
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color Scheme",
      "default": "scheme-1"
    },
    {
      "type": "select",
      "id": "title_font",
      "label": "t:global.typography.title_font.label",
      "options": [
        {
          "value": "primary",
          "label": "t:global.typography.title_font.primary.label"
        },
        {
          "value": "secondary",
          "label": "t:global.typography.title_font.secondary.label"
        }
      ],
      "default": "primary"
    },
    {
      "type": "select",
      "id": "title_size_blocks",
      "label": "t:global.typography.title_size.label",
      "options": [
        {
          "value": "h1",
          "label": "t:global.typography.title_size.h1.label"
        },
        {
          "value": "h2",
          "label": "t:global.typography.title_size.h2.label"
        },
        {
          "value": "h3",
          "label": "t:global.typography.title_size.h3.label"
        },
        {
          "value": "h4",
          "label": "t:global.typography.title_size.h4.label"
        },
        {
          "value": "h5",
          "label": "t:global.typography.title_size.h5.label"
        }
      ],
      "default": "h4"
    },
    {
      "type": "header",
      "content": "t:static_sections.footer.settings.bottom_bar.header"
    },
    {
      "id": "bottom_img",
      "type": "image_picker",
      "label": "t:static_sections.footer.settings.bottom_bar.bottom_img.label",
      "info": "t:static_sections.footer.settings.bottom_bar.bottom_img.info"
    },
    {
      "id": "bottom_img_width",
      "type": "range",
      "label": "t:static_sections.footer.settings.bottom_bar.bottom_img_width.label",
      "min": 50,
      "max": 200,
      "step": 5,
      "unit": "px",
      "default": 125
    },
    {
      "id": "bottom_img_link",
      "type": "url",
      "label": "t:static_sections.footer.settings.bottom_bar.bottom_img_link.label"
    },
    {
      "id": "enable_country_selector",
      "type": "checkbox",
      "label": "t:static_sections.footer.settings.bottom_bar.enable_country_selector.label",
      "info": "t:static_sections.footer.settings.bottom_bar.enable_country_selector.info",
      "default": false
    },
    {
      "id": "enable_language_selector",
      "type": "checkbox",
      "label": "t:static_sections.footer.settings.bottom_bar.enable_language_selector.label",
      "info": "t:static_sections.footer.settings.bottom_bar.enable_language_selector.info",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "enable_follow_on_shop",
      "label": "t:static_sections.footer.settings.bottom_bar.enable_follow_on_shop.label",
      "info": "t:static_sections.footer.settings.bottom_bar.enable_follow_on_shop.info"
    },
    {
      "type": "header",
      "content": "t:static_sections.footer.settings.payment_methods.header"
    },
    {
      "type": "checkbox",
      "id": "show_payment_methods",
      "label": "t:static_sections.footer.settings.payment_methods.show_payment_methods.label",
      "default": true
    },
    {
      "type": "header",
      "content": "t:global.spacing.header"
    },
    {
      "id": "spacing_desktop",
      "type": "range",
      "label": "t:global.spacing.spacing_desktop.label",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "default": 32
    },
    {
      "id": "spacing_mobile",
      "type": "range",
      "label": "t:global.spacing.spacing_mobile.label",
      "min": 0,
      "max": 60,
      "step": 4,
      "unit": "px",
      "default": 24
    }
  ],
  "blocks": [
    {
      "type": "@app"
    },
    {
      "type": "menu",
      "name": "t:static_sections.footer.blocks.menu.name",
      "limit": 1,
      "settings": [
        {
          "type": "link_list",
          "id": "menu",
          "label": "t:static_sections.footer.blocks.menu.settings.menu.label",
          "default": "footer"
        },
        {
          "type": "checkbox",
          "id": "split_menu",
          "label": "t:static_sections.footer.blocks.menu.settings.split_menu.label",
          "info": "t:static_sections.footer.blocks.menu.settings.split_menu.info"
        }
      ]
    },
    {
      "type": "text",
      "name": "t:static_sections.footer.blocks.text.name",
      "settings": [
        {
          "id": "title",
          "type": "inline_richtext",
          "label": "t:global.typography.title.label",
          "default": "Footer information"
        },
        {
          "type": "select",
          "id": "title_underline_style",
          "label": "t:global.typography.title_underline_style.label",
          "options": [
            {
              "value": "none",
              "label": "t:global.typography.title_underline_style.none.label"
            },
            {
              "value": "accent",
              "label": "t:global.typography.title_underline_style.accent.label"
            }
          ],
          "default": "none"
        },
        {
          "id": "text",
          "type": "richtext",
          "label": "t:static_sections.footer.blocks.text.settings.text.label",
          "default": "<p>Give your customers details about your online store.</p>"
        }
      ]
    },
    {
      "type": "html",
      "name": "t:static_sections.footer.blocks.html.name",
      "settings": [
        {
          "id": "html",
          "type": "html",
          "label": "t:static_sections.footer.blocks.html.settings.html.label"
        }
      ]
    },
    {
      "type": "customer_support",
      "name": "t:static_sections.footer.blocks.customer_support.name",
      "limit": 1,
      "settings": [
        {
          "id": "title",
          "type": "inline_richtext",
          "label": "t:global.typography.title.label",
          "default": "Customer service"
        },
        {
          "type": "select",
          "id": "title_underline_style",
          "label": "t:global.typography.title_underline_style.label",
          "options": [
            {
              "value": "none",
              "label": "t:global.typography.title_underline_style.none.label"
            },
            {
              "value": "accent",
              "label": "t:global.typography.title_underline_style.accent.label"
            }
          ],
          "default": "none"
        },
        {
          "id": "customer_support_img",
          "type": "image_picker",
          "label": "t:static_sections.footer.blocks.customer_support.settings.customer_support_img.label"
        },
        {
          "type": "richtext",
          "id": "extra_customer_support",
          "label": "t:static_sections.footer.blocks.customer_support.settings.extra_customer_support.label",
          "default": "<p>Give your customers more details about your online store.</p>"
        },
        {
          "type": "checkbox",
          "id": "show_phone_link",
          "label": "t:static_sections.footer.blocks.customer_support.settings.show_phone_link.label",
          "default": true
        },
        {
          "type": "checkbox",
          "id": "show_mail_link",
          "label": "t:static_sections.footer.blocks.customer_support.settings.show_mail_link.label",
          "default": true
        },
        {
          "type": "checkbox",
          "id": "show_whatsapp_link",
          "label": "t:static_sections.footer.blocks.customer_support.settings.show_whatsapp_link.label",
          "default": true
        }
      ]
    },
    {
      "type": "socials_newsletter",
      "name": "t:static_sections.footer.blocks.socials_newsletter.name",
      "limit": 1,
      "settings": [
        {
          "id": "title",
          "type": "text",
          "label": "t:static_sections.footer.blocks.socials_newsletter.settings.title.label",
          "default": "Follow us"
        },
        {
          "type": "checkbox",
          "id": "show_socials",
          "label": "t:static_sections.footer.blocks.socials_newsletter.settings.show_socials.label",
          "default": true
        },
        {
          "type": "checkbox",
          "id": "enable_follow_on_shop",
          "label": "t:static_sections.footer.blocks.socials_newsletter.settings.enable_follow_on_shop.label"
        },
        {
          "type": "header",
          "content": "t:static_sections.footer.blocks.socials_newsletter.settings.newsletter.header"
        },
        {
          "type": "checkbox",
          "id": "show_newsletter",
          "label": "t:static_sections.footer.blocks.socials_newsletter.settings.show_newsletter.label",
          "default": true
        },
        {
          "type": "select",
          "id": "footer_button_style",
          "label": "t:static_sections.footer.blocks.socials_newsletter.settings.footer_button_style.label",
          "options": [
            {
              "value": "primary plain",
              "label": "Primary"
            },
            {
              "value": "secondary plain",
              "label": "Secondary"
            },
            {
              "value": "tertiary plain",
              "label": "Tertiary"
            }
          ],
          "default": "primary plain"
        },
        {
          "type": "header",
          "content": "t:static_sections.footer.blocks.socials_newsletter.settings.checkbox.header"
        },
        {
          "id": "enable_newsletter_terms_checkbox",
          "type": "checkbox",
          "label": "Enable terms checkbox"
        },
        {
          "id": "newsletter_terms_text",
          "type": "richtext",
          "label": "Terms text"
        }
      ]
    }
  ],
  "default": {
    "blocks": [
      {
        "type": "menu"
      },
      {
        "type": "socials_newsletter"
      },
      {
        "type": "customer_support"
      }
    ]
  }
}
{% endschema %}
