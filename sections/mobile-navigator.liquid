{% liquid
  if section.settings.menu.links == blank
    assign main_menu_linklist = linklists[section.settings.menu].links
  else
    assign main_menu_linklist = section.settings.menu.links
  endif
%}

{% stylesheet %}
  .js-toggle-menu.active-submenu svg {
    transform: rotate(180deg);
    transition: transform 0.3s;
  }
{% endstylesheet %}

<!-- Footer Navigation for small screens -->
<footer class="fixed bottom-0 left-0 right-0 bg-white shadow-lg lg:hidden z-50 h-fit">
  <!-- search box dropdown for small screens -->
  <div id="mobile-search-overlay" class="fixed inset-0 bg-white z-50 hidden flex flex-col">
    <!-- هيدر البحث -->
    <div class="flex items-center justify-between p-4 border-b border-gray-200">
      <input
        id="mobile-search-input"
        type="search"
        class="flex-1 border-none focus:outline-none text-gray-800 text-base"
        placeholder="I'm searching for ..."
      >
      <button id="mobile-search-close" class="ml-4 text-gray-500">
        {% render 'icon-close' %}
      </button>
    </div>

    <!-- مكان النتائج -->
    <div id="mobile-search-results" class="flex-1 overflow-auto p-4"></div>
  </div>
  {% comment %}
    <div id="mobile-search-box" class="container mx-auto px-4 py-8 bg-[#c42764] text-white hidden xl:hidden">
      <div class="flex items-center text-white">
        <textarea
          class="focus:outline-none border-gray-300 bg-transparent font-semibold text-sm pl-4 w-full"
          type="text"
          placeholder="I'm searching for ..."
        ></textarea>
        {% render 'icon-search' %}
      </div>
    </div>
  {% endcomment %}

  <div
    class="container mx-auto px-4 py-2 flex justify-between items-center relative bg-[#c42764] text-white rounded-t-3xl shadow-lg"
  >
    <!-- Left Icon -->
    <div class="flex px-2 justify-between w-2/5 items-center hover:text-white">
      <a href="{{ routes.root_url }}" class="flex flex-col w-1/2 items-center hover:text-white">
        {% render 'icon-home' %}
        <span class="text-xs">home</span>
      </a>

      <a href="#" class="flex flex-col w-1/2 items-center hover:text-white">
        {% render 'icon-user' %}
        <span class="text-xs">Account</span>
      </a>
    </div>

    <!-- space in center bar -->
    <span class="flex flex-col items-center hover:text-white"> </span>

    <!-- Center Circular Icon -->
    <div
      class="absolute bg-white -top-10 left-1/2 transform -translate-x-1/2 rounded-full border-b border-gray-200 p-4 flex items-center justify-center"
    >
      <button class="flex mobile-footer-burger border-none rounded-md focus:outline-none flex-col items-center">
        <div class="bg-[#c42764] h-10 w-10 rounded-full justify-center items-center flex">
          {% render 'icon-menu' %}
        </div>
      </button>
    </div>

    <!-- Search Icon -->
    <div class="flex px-2 justify-between w-2/5 items-center hover:text-white">
      <button id="mobile-search-btn" class="flex flex-col w-1/2 items-center">
        {% render 'icon-search' %}
        <span class="text-xs">Search</span>
      </button>
      <a href="{{ routes.cart_url }}" class="flex flex-col w-1/2 items-center hover:text-white">
        {% render 'icon-cart' %}
        <span class="text-xs">Cart</span>
      </a>
    </div>
  </div>
</footer>

<div class="mobile-footer-menu relative z-50 hidden">
  <div class="mobile-footer-backdrop fixed inset-0 bg-gray-800 opacity-25"></div>
  <nav
    class="fixed top-0 left-0 bottom-0 flex flex-col w-full max-w-sm pt-6 bg-white shadow-md overflow-y-auto list-none"
  >
    <div class="flex items-center mb-8 px-5">
      <a class="mr-auto text-xl font-bold leading-none" href="#">
        {% if settings.logo != blank %}
          <img
            src="{{ settings.logo | image_url }}"
            alt="Shop logo displaying {{ shop.name }} in a welcoming style, positioned in the website header area"
            class="header__logo"
            width="{{ size }}"
            height="50"
          >
        {% else %}
          {{ shop.name }}
        {% endif %}
      </a>
      <button class="mobile-footer-close">
        {% render 'icon-close' %}
      </button>
    </div>
    {% for link in main_menu_linklist %}
      {% if link.links != blank %}
        <li class="relative w-full">
          <button
            class="text-sm px-8 flex flex-row items-center justify-between w-full h-12 js-toggle-footer-menu {% if link.active == true or link.child_active == true %}text-white font-bold bg-[#c42764]{% endif %}"
            data-target="menu-{{ link.title | handleize }}"
            type="button"
          >
            {{ link.title }}
            {% render 'icon-chevron-down' %}
          </button>
          <div class="w-full border-t bg-white text-[#c42764] z-10 hidden" id="menu-{{ link.title | handleize }}">
            <ul>
              {% for childlink in link.links %}
                {% if childlink.links != blank %}
                  <li class="relative">
                    <button
                      class="text-sm px-8 flex flex-row items-center justify-between w-full h-12 js-toggle-footer-menu"
                      data-target="menu-{{ childlink.title | handleize }}"
                      type="button"
                    >
                      {{ childlink.title }}
                      {% render 'icon-chevron-down' %}
                    </button>
                    <div
                      class="w-full border-t bg-white text-[#c42764] z-10 hidden"
                      id="menu-{{ childlink.title | handleize }}"
                    >
                      <ul>
                        {% for grandchild in childlink.links %}
                          <li class="hover:bg-[#c42764] hover:text-white">
                            <a class="block py-2 px-12" href="{{ grandchild.url }}">
                              {{ grandchild.title }}
                            </a>
                          </li>
                        {% endfor %}
                      </ul>
                    </div>
                  </li>
                {% else %}
                  <li class="hover:bg-[#c42764] hover:text-white">
                    <a class="block py-2 px-8" href="{{ childlink.url }}">
                      {{ childlink.title }}
                    </a>
                  </li>
                {% endif %}
              {% endfor %}
            </ul>
          </div>
        </li>
      {% else %}
        <li class="w-full px-8 {% if link.active == true %}text-white font-bold bg-[#c42764]{% endif %}">
          <a
            class="text-sm flex justify-start items-center text-gray-400 hover:text-gray-500 w-full h-12"
            href="{{ link.url }}"
          >
            {{ link.title }}
          </a>
        </li>
      {% endif %}
    {% endfor %}
    <div class="mt-auto bg-[#c42764] py-3">
      <p class="text-xs text-center text-gray-400">
        <span>Copyright © 2024</span>
      </p>
    </div>
  </nav>
</div>

{% schema %}
{
  "name": "Mobile Navigational Bar",
  "settings": [
    {
      "type": "link_list",
      "id": "menu",
      "label": "Mobile Menu",
      "default": "main-menu"
    }
  ]
}
{% endschema %}
