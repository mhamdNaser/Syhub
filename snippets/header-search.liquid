<details-modal class="header__search relative">
  <details>
    <!-- زر الأيقونة فقط -->
    <summary
      class="cursor-pointer group p-2 flex items-center justify-center text-gray-500"
      aria-haspopup="dialog"
      aria-label="{{ 'general.search.search' | t }}"
    >
      <div class="flex items-center text-md justify-between border border-neutral-400 rounded-3xl py-2 px-4">
        {% comment %} {{ 'general.search.search' | t }} {% endcomment %}
        <span class="space-x-24"> search Products </span>
        <span class="svg-wrapper w-6 h-6 ms-16 group-hover:text-[#c42764]">
          {% render 'icons', icon: 'icon-search' , icon_size: '24' %}
        </span>
      </div>
    </summary>

    <!-- المودال عند الفتح -->
    <div
      class="fixed inset-0 w-full top-0 left-0 z-50 h-[180px] bg-white flex items-center justify-center"
      role="dialog"
      aria-modal="true"
      aria-label="{{ 'general.search.search' | t }}"
    >
      <div class="absolute inset-0">
        <button
          type="button"
          class="absolute top-3 right-3 text-gray-600 hover:text-black"
          aria-label="{{ 'accessibility.close' | t }}"
          onclick="this.closest('details').removeAttribute('open')"
        >
          <span class="w-6 h-6">{% render 'icons', icon: 'icon-close' , icon_size: '24' %}</span>
        </button>
      </div>
      <!-- خلفية شفافة -->

      <div class="relative z-40 w-full max-w-7xl justify-between mx-auto">
        <div class="flex items-center justify-between mb-4 py-3">
          <!-- لوغو الموقع -->
          <a href="{{ shop.url }}" class="flex-shrink-0">
            <h2 class="header__title" {{ block.shopify_attributes }}>
              <img
                src="{{ settings.logo | image_url }}"
                alt="Shop logo displaying {{ shop.name }} in a welcoming style, positioned in the website header area"
                class="header__logo"
                width="180"
                height="100"
              >
            </h2>
          </a>

          <!-- فورم البحث بالمنتصف -->
          <form
            action="{{ routes.search_url }}"
            method="get"
            role="search"
            class="flex-1 mx-6 flex items-center border border-gray-200 rounded-md p-4 gap-2 relative max-w-3xl"
          >
            <input
              id="search-input"
              type="search"
              name="search"
              value="{{ search.terms | escape }}"
              placeholder="{{ 'general.search.search' | t }}"
              class="flex-grow px-4 text-lg border-0 outline-none"
            >
            <button
              class="text-gray-600 hover:text-blue-600"
              aria-label="{{ 'general.search.search' | t }}"
              type="submit"
            >
              <span class="w-5 h-5">{%- render 'icons' , icon: 'icon-search' , icon_size: '24' %}</span>
            </button>

            <!-- هنا سيظهر الأوتوكومبليت -->
            <div
              id="search-results"
              class="absolute top-full left-0 w-full bg-white border border-gray-200 rounded-md shadow-lg z-50 px-6 py-4  max-h-[480px] overflow-y-auto"
            ></div>
          </form>

          <!-- الأيقونتان على اليمين -->
          <div class="flex items-center space-x-4 flex-shrink-0">
            <div class="header__icons" {{ block.shopify_attributes }}>
              {% if shop.customer_accounts_enabled %}
                {%- render 'icons' , icon: 'icon-user' -%}
              {% endif %}

              <a href="{{ routes.cart_url }}" aria-label="cart">
                {% if cart.item_count > 0 %}
                  <sup>{{ cart.item_count }}</sup>
                {% endif %}
                {%- render 'icons' , icon: 'icon-cart' -%}
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </details>
</details-modal>

<script src="{{ 'plugin-search.js' | asset_url }}" defer></script>
